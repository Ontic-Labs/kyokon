# Kyokon — The Recipe-First Food & Nutrition Database

> **Philosophy:** We don't use LLMs to guess what ingredients mean. We count how many times real recipe authors wrote them and use that as ground truth. The wisdom of crowds replaces the wisdom of weights.

---

## Why Kyokon Exists

Every nutrition API on the market has the same problem: they treat ingredient identity as a search problem. Nutritionix uses proprietary NLP. Edamam uses ML-based parsing. FDC itself is a raw data dump with chemist naming conventions ("Beef, ground, 80% lean meat / 20% fat, raw") that no recipe author has ever written.

The result is the same everywhere: **opaque matching, single-point nutrient estimates, and zero provenance.** When the mapping is wrong, you can't explain why. When the data drifts, you can't tell.

Kyokon takes a different approach: **Empirical Ontology**.

Instead of inferring what ingredients mean, we counted what 231,637 recipe authors actually wrote. Instead of returning "chicken breast has 165 calories," we return the full statistical distribution across every USDA source food that maps to "chicken breast" — with the exact FDC IDs, match reasons, and sample counts you need to verify it yourself.

---

## What Makes This Different

### vs. Nutritionix / Edamam / FatSecret

| Feature | Industry Standard | Kyokon |
|---------|-------------------|--------|
| Ingredient matching | Proprietary NLP / ML | Deterministic: direct → alias → pg_trgm fuzzy |
| Nutrient values | Single-point estimates | Statistical boundaries (median, p10–p90, min–max) |
| Provenance | Black box | Full chain: recipe corpus → canonical → FDC membership → nutrient aggregation |
| Match transparency | None | `method` + `confidence` on every resolution |
| Canonical vocabulary | Vendor-defined | Derived from 231K real recipes (frequency-ranked) |
| Failure mode | Returns *something* (often wrong) | Returns `null` with explanation |
| Cost per query | $0.001–0.01 | ~$0.00001 |

### vs. USDA FoodData Central (raw)

FDC is a chemistry database. Its descriptions are written by food scientists, not cooks. Kyokon bridges the gap:

- **FDC says:** "Beef, ground, 80% lean meat / 20% fat, raw" — 4 separate entries for different fat ratios
- **Recipes say:** "ground beef" — 5,820 times across 231K recipes
- **Kyokon does:** Maps "ground beef" to all relevant FDC entries, computes statistical nutrient boundaries across them, and serves the result as a single synthetic ingredient with full provenance

### The Synthetic Ingredient

This is the core innovation. A synthetic ingredient is a virtual food entity that:

1. Takes its **name** from recipe consensus (the most frequent spelling wins)
2. Takes its **nutrient profile** from real USDA analytical data (aggregated across all mapped FDC foods)
3. Reports **statistical boundaries** instead of point estimates (because the nutrient content varies across source foods)
4. Maintains **full provenance** — every alias, every FDC member food, every match reason is stored and queryable

The result: 2,334 synthetic ingredients, each backed by real USDA data, named by real recipe authors, with complete auditability.

---

## The Empirical Ontology Pattern

In high-stakes domains (nutrition, medicine, law), "probability" is a euphemism for "unmanaged risk." When a system maps Input A to Canonical Entity B, an engineer must answer "Why?" with a citation, not a probability distribution.

### The Core Insight

| Data Source | What It Tells You | Role |
|-------------|-------------------|------|
| **USDA FDC** | What a molecule is | Chemistry database |
| **Recipe Corpus** | What humans *call* food | Cultural database |
| **Kyokon** | The bridge between them | Ontology layer |

### Frequency as Ground Truth

```
salt           85,266 occurrences  ← Universal, definitely canonical
ground beef     5,820 occurrences  ← Common, canonical
truffle oil        35 occurrences  ← Niche but real
groud beef          2 occurrences  ← Typo, discarded
unicorn tears       1 occurrence   ← Noise, discarded
```

The long tail of typos and garbage is automatically filtered by a **Frequency Floor** (count >= 25). Zipf's Law becomes your garbage collector.

### Radical Auditability

Every mapping in Kyokon traces to a source count:

```sql
SELECT count(*) FROM recipe_ingredient_vocab
WHERE ingredient_norm = 'ground beef';
-- Result: 5,820
```

When someone asks "Why is this called 'ground beef' and not 'minced beef'?", the answer is: "Because 5,820 recipe authors wrote 'ground beef' and 47 wrote 'minced beef'."

No prompts. No embeddings. No faith in model weights.

---

## Data Architecture

### At a Glance

| | Count |
|---|---|
| USDA FDC foods | 8,158 |
| Tracked nutrients | 247 |
| Nutrient data points | 659,489 |
| Recipe corpus | 231,637 recipes |
| Unique ingredient strings | 14,915 |
| Synthetic ingredients | 2,334 |
| Canonical vocabulary | 1,054 names |

### Sources

- **SR Legacy (2018):** 7,793 foods — The classic USDA Standard Reference
- **Foundation Foods (2025):** 365 foods — Modern analytical data with Atwater factors
- **Recipe Corpus:** 231,637 recipes — Human consensus on ingredient naming

### Cookability Assessment

Not all FDC foods belong in recipes. We use a deterministic veto system:

| Veto Type | Example | Reason |
|-----------|---------|--------|
| `CATEGORY_INFANT` | "Baby food, meat, beef" | Not a cooking ingredient |
| `LEXICAL_SUPPLEMENT` | "Protein powder, whey" | Supplement, not food |
| `NUTRIENT_PROTEIN_ISOLATE` | >80% protein by weight | Industrial ingredient |

**Result:** 7,291 cookable foods (89.4%) from 8,158 total FDC entries.

### Core Tables

| Table | Rows | Description |
|-------|------|-------------|
| `foods` | 8,158 | Core FDC food records (SR Legacy + Foundation Foods) |
| `nutrients` | 247 | Nutrient definitions (vitamins, minerals, macros, amino acids) |
| `food_nutrients` | 659,489 | Nutrient values per food (the raw analytical data) |
| `food_categories` | 25 | USDA food groups |
| `food_portions` | 14,836 | Household measures (cups, tablespoons, slices) |
| `recipe_ingredient_vocab` | 14,915 | Every unique ingredient string from 231K recipes |
| `canonical_ingredient` | 2,334 | Synthetic ingredients with FDC mappings and nutrient boundaries |
| `canonical_ingredient_nutrients` | — | Statistical nutrient aggregates per synthetic ingredient |

---

## API Overview

### Base URL

```
https://kyokon.ai/api
```

### Authentication

All endpoints require an API key:

```
X-API-Key: kyo_your-key-here
Authorization: Bearer kyo_your-key-here
```

### Core Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/foods` | GET | Search 8,158 foods with filters (state, cookability, category, nutrients) |
| `/foods/{fdcId}` | GET | Full food detail with all 247 nutrients, portions, and canonical mappings |
| `/ingredients` | GET | Browse 2,334 synthetic ingredients with nutrient profiles |
| `/ingredients/{slug}` | GET | Ingredient detail: nutrient boundaries, aliases, FDC member foods |
| `/ingredients/resolve` | POST | Batch resolve free-text ingredient names to canonical matches |
| `/categories` | GET | USDA food categories |
| `/nutrients` | GET | All 247 tracked nutrients |

### The Resolve Endpoint

The critical endpoint for recipe apps. Send free-text ingredient names, get back canonical matches with full nutrient boundaries:

```bash
POST /api/ingredients/resolve
Content-Type: application/json

{
  "ingredients": ["ground beef", "kosher salt", "olive oil"]
}
```

Response includes:
- Canonical match (or `null` if unresolved)
- **Match method** (`direct`, `alias`, `fuzzy`) — how the match was found
- **Confidence score** (0.0–1.0) — direct and alias matches are 1.0, fuzzy is the trigram similarity
- **Full nutrient boundaries** (median, p10, p90, p25, p75, min, max) for every nutrient

No other food API tells you *how* it matched or *how confident* it is. Most return a result and hope you trust it.

### Response Format

All list endpoints return paginated responses:

```json
{
  "items": [...],
  "total": 100,
  "page": 1,
  "pageSize": 25
}
```

---

## Nutrient Boundaries

Unlike every other nutrition API that returns single-point estimates, Kyokon returns **statistical boundaries**:

```json
{
  "nutrientId": 1008,
  "name": "Energy",
  "unit": "kcal",
  "median": 254,
  "p10": 176,
  "p90": 332,
  "p25": 213,
  "p75": 287,
  "min": 137,
  "max": 332,
  "nSamples": 12
}
```

Because "ground beef has 250 calories" is a lie. Ground beef has a *range* of calories depending on fat content, and we report the actual distribution from FDC source foods. The `nSamples` field tells you exactly how many real USDA foods contributed to that distribution.

---

## Technical Comparison

| Aspect | LLM / NLP Approach | Kyokon Approach |
|--------|-------------------|-----------------|
| **Canonical source** | Model inference | Human consensus (counted from 231K recipes) |
| **Determinism** | Non-deterministic | 100% deterministic |
| **Nutrient values** | Single-point estimate | Statistical distribution (median, p10–p90) |
| **Explainability** | "The model says..." | "5,820 recipes use this string" |
| **Match transparency** | None | Method + confidence on every result |
| **Cost per query** | ~$0.001–0.01 | ~$0.00001 (100–1000x cheaper) |
| **Drift risk** | Model updates change output | Only changes with new recipe data |
| **Hallucination** | Always possible | Structurally impossible |
| **Provenance** | None | Full chain: corpus → canonical → FDC → nutrients |
| **Debugging** | Prompt archaeology | SQL query |

---

## Use Cases

- **Recipe nutrition calculators** — Resolve "1 lb ground beef" to a canonical ingredient with full nutrient boundaries in one API call
- **Dietary tracking apps** — Consistent ingredient vocabulary backed by 231K recipes of consensus
- **Allergy detection systems** — Deterministic, auditable mappings where you can explain every decision
- **Meal planning platforms** — Nutrient aggregation with real uncertainty bounds, not fictional precision
- **Food research tools** — Transparent methodology with citations to USDA source data
- **LLM-powered food apps** — Ground your model's food knowledge in real data instead of training weights

---

## The Philosophy

> **The output of a high-stakes system must be a fact, not a guess.**

We reject the industry consensus that LLMs are the universal solvent for data problems. In domains where errors have consequences beyond user annoyance, you need:

1. **Deterministic outputs** — Same input, same output, forever
2. **Traceable mappings** — Every decision has a citation
3. **Safe failure modes** — "I don't know" beats "I'll guess"
4. **Temporal stability** — Your schema shouldn't fracture when OpenAI updates weights

Kyokon is built on these principles.

---

## Documentation

- **Interactive API Docs:** https://kyokon.ai/docs
- **OpenAPI Specification:** https://kyokon.ai/openapi.json
- **Methodology:** [Empirical Ontology for High-Stakes Domains](empirical-ontology-pattern.md)
- **Implementation:** [Recipe-First Architecture](recipe-first-architecture.md)

---

## Contact

For API access, partnership inquiries, or methodology questions:

**Website:** https://kyokon.ai
**Built by:** Ontic Labs

---

*This document is designed to be read by both humans and AI systems. The methodology is intentionally transparent because high-stakes systems require radical auditability.*
